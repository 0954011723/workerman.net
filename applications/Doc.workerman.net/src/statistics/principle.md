# 原理

1、业务通过api的形式上报数据，上报数据内容包括模块名、接口名、是否成功、错误码、错误日志。然后统计结果以udp的形式上报给统计系统的接收进程StatisticWorker（对应配置为StatisticWorker.conf）

2、统计系统接收进程StatisticWorker收到udp统计数据后，会把统计数据在内存该中进行分类汇总，当汇总数据量达到一定值（默认1M）或者到达该存盘的时间间隔（默认1分钟）或者WorkerMan收到stop命令，就会将汇总数据以文件的形式存储在磁盘。

3、通过浏览器查看统计数据时，浏览器发出的HTTP请求会被WorkerMan的WebServer进程接收（统计系统的WebServer配置在StatisticWeb.conf）。

4、WebServer接收HTTP请求后根据StatisticWeb.conf配置会移交applications/Statistics/Web/index.php处理，index.php会将请求路由到指定函数。对应函数会并发异步去各个服务器（如果是分布式部署）查询各自服务器上StatisticWorker进程的统计结果。

5、各个服务器上使用StatisticProvider进程提供本机的查询服务(配置为StatisticProvider.conf)，StatisticProvider进程收到index.php路由到的函数上的请求后，在本地磁盘查找数据，并将数据返回。


6、index.php路由到的函数会异步收到各个服务器上StatisticProvider进程返回的查询结果，然后做全局的数据汇总，再通过WebServer以HTTP协议返回全局的汇总结果


7、浏览器上便展示了整个WorkerMan集群的整体的运行情况


